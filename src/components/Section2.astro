---
import edificios from "../assets/edificios.png";
---

<main
    id="mainSection"
    class="relative h-lvh w-full flex items-center justify-center
        text-3xl font-bold text-white"
>
    <div
        id="edificios"
        class="absolute inset-0 h-full z-10 bg-no-repeat bg-cover bg-bottom"
        style={`background-image: url(${edificios.src});`}
    >
        <section>seccion 2</section>
        <section>seccion 2</section>
        <section>seccion 2</section>
        <section>seccion 2</section>
    </div>
</main>

<style>
    main {
        overflow-x: hidden;

        /* Atardecer */
        background: linear-gradient(
            to bottom,
            black 20%,
            #ea580c 65%,    /* orange-600 de Tailwind en hex */
            #fde68a 100%   /* yellow-300 de Tailwind en hex */
        );

        background: linear-gradient(
            to bottom,
            black 20%,           /* Negro s√≥lido arriba */
            #050f2c 65%,        /* Azul oscuro (blue-900) */
            #1e3a8a 100%        /* Azul claro (blue-400) */
        );
    }
    #edificios {
        display: flex;
        width: 400vw;
        background-repeat: repeat-x;
        background-position: bottom;
    }

    section {
        width: 100vw;
        display: grid;
        place-items: center;
    }
</style>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    const main = document.querySelector("main") as HTMLElement;
    const edificios = document.getElementById("edificios") as HTMLElement;
    const sections = Array.from(
        edificios.querySelectorAll("section"),
    ) as HTMLElement[];
    const numSections = sections.length;

    edificios.style.width = `${numSections * 100}vw`;
    edificios.style.backgroundSize = `calc(115% / ${numSections}) auto`;

    gsap.to(edificios, {
        x: () => `-${edificios.scrollWidth - main.clientWidth}px`,
        ease: "none",
        scrollTrigger: {
            trigger: main,
            start: "top top",
            end: () => `+=${edificios.scrollWidth - main.clientWidth}`,
            scrub: 1,
            pin: true,
            anticipatePin: 1,
            invalidateOnRefresh: true,
        },
    });
</script>
